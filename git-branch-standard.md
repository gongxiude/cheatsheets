---
title: Git branches standard
category: Git 
layout: 2017/sheet
updated: 2017-09-20
intro: |
  git分支规范
---
{: .-one-column}
### 使用规范

> 所有使用了本规范的项目，必须严格规范操作，否则不予以合并代码、提测、打包上线等后续操作。

### branch使用规范

#### 分支约定

Git Flow有主分支和辅助分支两类分支。其中主分支用于组织与软件开发、部署相关的活动；辅助分支组织为了解决特定的问题而进行的各种活动主分支是所有开发活动的核心分支。所有的开发活动产生的输出物最终都会反映到主分支的代码中。主分支分为**master**分支和**develop**分支。

##### 主分支

###### `master`分支

- master分支存放的是随时可供在生产环境中部署的稳定版本代码
- master分支保存官方发布版本历史，release tag标识不同的发布版本
- 一个项目只能有一个master分支
- **仅在发布新的可供部署的代码时才更新master分支上的代码**
- 每次更新master，都需对master添加指定格式的tag，用于发布或回滚
- master分支是保护分支，不可直接push到远程仓master分支
- master分支代码只能被hotfix分支合并

###### `develop`分支

- develop 为测试分支，一般包含正在开发的所有新特性，主要用来为发布新版的测试、修复做准备
- develop分支与master分支直接交互，Develop分支测试通过后，合并到master分支并且给master标记一个版本号
- develop分支衍生出各个feature分支
- develop分支是保护分支，不可直接push到远程仓库develop分支
- 一个项目只能有一个develop分支

 

##### 辅助分支

辅助分支是用于组织解决特定问题的各种软件活动的分支。辅助分支主要用于组织软件新功能的并行开发、简化新功能开发代码的跟踪、辅助完成版本发布工作以及对生产代码的缺陷进行紧急修复工作、以及对版本代码的测试。这些分支与主分支不同，通常只会在有限的时间范围内存在。

辅助分支包括：

- 用于开发新功能时所使用的feature分支
- 用于紧急修正生产代码中的缺陷的hotfix分支
- 用于修正代码中的缺陷的bugfix分支

> 以上这些分支都有固定的使用目的和分支操作限制。从单纯技术的角度说，这些分支与Git其他分支并没有什么区别，但通过命名，我们定义了使用这些分支的方法。

###### `feature`分支

使用规范：

- 命名规则：`feature-*`
- develop分支的功能分支
- feature分支使用develop分支作为它们的父类分支
- 以功能为单位从develop拉一个feature分支
- 每个feature分支颗粒要尽量小，以利于快速迭代和避免冲突
- 当其中一个feature分支完成后，它会合并回develop分支
- 当一个功能因为各种原因不开发了或者放弃了，这个分支直接废弃，不影响develop分支
- feature分支代码可以保存在开发者自己的代码库中而不强制提交到主代码库里
- feature分支只与develop分支交互，不能与master分支直接交互

> 如有几个同事同时开发，需要分割成几个小功能，每个人都需要从develop中拉出一个feature分支，但是每个feature颗粒要尽量小，因为它需要我们能尽早merge回develop分支，否则冲突解决起来就没完没了。同时，当一个功能因为各种原因不开发了或者放弃了，这个分支直接废弃，不影响develop分支。

 

###### `hotfix`分支

使用规范：

- 命名规则：`hotfix-*`
- hotfix分支用来快速给已发布产品修复bug或微调功能
- 只能从master分支指定tag版本衍生出来
- 一旦完成修复bug，必须合并回master分支
- master被合并后，应该被标记一个新的版本号
- hotfix分支一旦建立就将独立，不可再从其他分支pull代码

> 除了是计划外创建的以外，都可以产生一个新的可供在生产环境部署的软件版本。当生产环境中的软件遇到了异常情况或者发现了严重到必须立即修复的软件缺陷的时候，就需要从master分支上指定的TAG版本派生hotfix分支来组织代码的紧急修复工作。这样做的显而易见的好处是不会打断正在进行的develop分支的开发工作，能够让团队中负责新功能开发的人与负责代码紧急修复的人并行的开展工作。

###### `bugfix`分支

- 修补分支：软件发布以后，难免会出现bug。这时就需要创建一个分支，进行bug修补
- 修补bug分支是从develop分支上面分出来的。修补结束以后，再合并进develop对应版本分支。它的命名，可以采用 _ fixbug- *_ （日期）的形式。

##### 分支责任分工

| 分支    | 职责描述                                                     |
| ------- | ------------------------------------------------------------ |
| master  | **开发经理** ：统一创建、维护                                |
| develop | **开发经理** ：统一创建， **开发人员**： 维护， 部署         |
| feature | **开发人员** ：各模块自行创建、维护                          |
| fixbug  | ** **开发人员** ：各模块自行创建、维护，修复bug，协助解决自动merge中发生的冲突 |

 